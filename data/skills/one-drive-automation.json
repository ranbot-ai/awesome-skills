{
  "id": "composio-one-drive-automation",
  "name": "one-drive-automation",
  "slug": "one-drive-automation",
  "description": "Automate OneDrive file management, search, uploads, downloads, sharing, permissions, and folder operations via Rube MCP (Composio). Always search tools first for current schemas.",
  "category": "Development & Code Tools",
  "source": "composio",
  "repoUrl": "https://github.com/ComposioHQ/awesome-claude-skills",
  "skillUrl": "https://github.com/ComposioHQ/awesome-claude-skills/tree/master/one-drive-automation",
  "content": "\n# OneDrive Automation via Rube MCP\n\nAutomate OneDrive operations including file upload/download, search, folder management, sharing links, permissions management, and drive browsing through Composio's OneDrive toolkit.\n\n## Prerequisites\n\n- Rube MCP must be connected (RUBE_SEARCH_TOOLS available)\n- Active OneDrive connection via `RUBE_MANAGE_CONNECTIONS` with toolkit `one_drive`\n- Always call `RUBE_SEARCH_TOOLS` first to get current tool schemas\n\n## Setup\n\n**Get Rube MCP**: Add `https://rube.app/mcp` as an MCP server in your client configuration. No API keys needed â€” just add the endpoint and it works.\n\n\n1. Verify Rube MCP is available by confirming `RUBE_SEARCH_TOOLS` responds\n2. Call `RUBE_MANAGE_CONNECTIONS` with toolkit `one_drive`\n3. If connection is not ACTIVE, follow the returned auth link to complete Microsoft OAuth\n4. Confirm connection status shows ACTIVE before running any workflows\n\n## Core Workflows\n\n### 1. Search and Browse Files\n\n**When to use**: User wants to find files or browse folder contents in OneDrive\n\n**Tool sequence**:\n1. `ONE_DRIVE_GET_DRIVE` - Verify drive access and get drive details [Prerequisite]\n2. `ONE_DRIVE_SEARCH_ITEMS` - Keyword search across filenames, metadata, and content [Required]\n3. `ONE_DRIVE_ONEDRIVE_LIST_ITEMS` - List all items in the root of a drive [Optional]\n4. `ONE_DRIVE_GET_ITEM` - Get detailed metadata for a specific item, expand children [Optional]\n5. `ONE_DRIVE_ONEDRIVE_FIND_FILE` - Find a specific file by exact name in a folder [Optional]\n6. `ONE_DRIVE_ONEDRIVE_FIND_FOLDER` - Find a specific folder by name [Optional]\n7. `ONE_DRIVE_LIST_DRIVES` - List all accessible drives [Optional]\n\n**Key parameters**:\n- `q`: Search query (plain keywords only, NOT KQL syntax)\n- `search_scope`: `\"root\"` (folder hierarchy) or `\"drive\"` (includes shared items)\n- `top`: Max items per page (default 200)\n- `skip_token`: Pagination token from `@odata.nextLink`\n- `select`: Comma-separated fields to return (e.g., `\"id,name,webUrl,size\"`)\n- `orderby`: Sort order (e.g., `\"name asc\"`, `\"name desc\"`)\n- `item_id`: Item ID for `GET_ITEM`\n- `expand_relations`: Array like `[\"children\"]` or `[\"thumbnails\"]` for `GET_ITEM`\n- `user_id`: `\"me\"` (default) or specific user ID/email\n\n**Pitfalls**:\n- `ONE_DRIVE_SEARCH_ITEMS` does NOT support KQL operators (`folder:`, `file:`, `filetype:`, `path:`); these are treated as literal text\n- Wildcard characters (`*`, `?`) are NOT supported and are auto-removed; use file extension keywords instead (e.g., `\"pdf\"` not `\"*.pdf\"`)\n- `ONE_DRIVE_ONEDRIVE_LIST_ITEMS` returns only root-level contents; use recursive `ONE_DRIVE_GET_ITEM` with `expand_relations: [\"children\"]` for deeper levels\n- Large folders paginate; always follow `skip_token` / `@odata.nextLink` until exhausted\n- Some drive ID formats may return \"ObjectHandle is Invalid\" errors due to Microsoft Graph API limitations\n\n### 2. Upload and Download Files\n\n**When to use**: User wants to upload files to OneDrive or download files from it\n\n**Tool sequence**:\n1. `ONE_DRIVE_ONEDRIVE_FIND_FOLDER` - Locate the target folder [Prerequisite]\n2. `ONE_DRIVE_ONEDRIVE_UPLOAD_FILE` - Upload a file to a specified folder [Required for upload]\n3. `ONE_DRIVE_DOWNLOAD_FILE` - Download a file by item ID [Required for download]\n4. `ONE_DRIVE_GET_ITEM` - Get file details before download [Optional]\n\n**Key parameters**:\n- `file`: FileUploadable object with `s3key`, `mimetype`, and `name` for uploads\n- `folder`: Destination path (e.g., `\"/Documents/Reports\"`) or folder ID for uploads\n- `item_id`: File's unique identifier for downloads\n- `file_name`: Desired filename with extension for downloads\n- `drive_id`: Specific drive ID (for SharePoint or OneDrive for Business)\n- `user_id`: `\"me\"` (default) or specific user identifier\n\n**Pitfalls**:\n- Upload automatically renames on conflict (no overwrite option by default)\n- Large files are automatically handled via chunking\n- `drive_id` overrides `user_id` when both are provided\n- Item IDs vary by platform: OneDrive for Business uses `01...` prefix, OneDrive Personal uses `HASH!NUMBER` format\n- Item IDs are case-sensitive; use exactly as returned from API\n\n### 3. Share Files and Manage Permissions\n\n**When to use**: User wants to share files/folders or manage who has access\n\n**Tool sequence**:\n1. `ONE_DRIVE_ONEDRIVE_FIND_FILE` or `ONE_DRIVE_ONEDRIVE_FIND_FOLDER` - Locate the item [Prerequisite]\n2. `ONE_DRIVE_GET_ITEM_PERMISSIONS` - Check current permissions [Prerequisite]\n3. `ONE_DRIVE_INVITE_USER_TO_DRIVE_ITEM` - Grant access to specific users [Required]\n4. `ONE_DRIVE_CREATE_LINK` - Create a shareable link [Optional]\n5. `ONE_DRIVE_UPDATE_DRIVE_ITEM_METADATA` - Update item metadata [Optional]\n\n**Key parameters**:\n- `item_id`: The file or folder to share\n- `recipients`: Array of objects with `email` or `object_id`\n- `roles`: Array with `\"read\"` or `\"write\"`\n- `send_invitation`: `true` to send notification email, `false` for silent permission grant\n- `require_sign_in`: `true` to require a",
  "tags": [
    "api",
    "pdf",
    "cli",
    "mcp",
    "automation",
    "ai"
  ],
  "useCases": [],
  "scrapedAt": "2026-02-06T07:03:21.185Z"
}