{
  "id": "antigravity-azure-ai-agents-persistent-dotnet",
  "name": "azure-ai-agents-persistent-dotnet",
  "slug": "azure-ai-agents-persistent-dotnet",
  "description": "Azure AI Agents Persistent SDK for .NET. Low-level SDK for creating and managing AI agents with threads, messages, runs, and tools. Use for agent CRUD, conversation threads, streaming responses, function calling, file search, and code interpreter. Triggers: \"PersistentAgentsClient\", \"persistent agen",
  "category": "AI & Agents",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/azure-ai-agents-persistent-dotnet",
  "content": "\n# Azure.AI.Agents.Persistent (.NET)\n\nLow-level SDK for creating and managing persistent AI agents with threads, messages, runs, and tools.\n\n## Installation\n\n```bash\ndotnet add package Azure.AI.Agents.Persistent --prerelease\ndotnet add package Azure.Identity\n```\n\n**Current Versions**: Stable v1.1.0, Preview v1.2.0-beta.8\n\n## Environment Variables\n\n```bash\nPROJECT_ENDPOINT=https://<resource>.services.ai.azure.com/api/projects/<project>\nMODEL_DEPLOYMENT_NAME=gpt-4o-mini\nAZURE_BING_CONNECTION_ID=<bing-connection-resource-id>\nAZURE_AI_SEARCH_CONNECTION_ID=<search-connection-resource-id>\n```\n\n## Authentication\n\n```csharp\nusing Azure.AI.Agents.Persistent;\nusing Azure.Identity;\n\nvar projectEndpoint = Environment.GetEnvironmentVariable(\"PROJECT_ENDPOINT\");\nPersistentAgentsClient client = new(projectEndpoint, new DefaultAzureCredential());\n```\n\n## Client Hierarchy\n\n```\nPersistentAgentsClient\n├── Administration  → Agent CRUD operations\n├── Threads         → Thread management\n├── Messages        → Message operations\n├── Runs            → Run execution and streaming\n├── Files           → File upload/download\n└── VectorStores    → Vector store management\n```\n\n## Core Workflow\n\n### 1. Create Agent\n\n```csharp\nvar modelDeploymentName = Environment.GetEnvironmentVariable(\"MODEL_DEPLOYMENT_NAME\");\n\nPersistentAgent agent = await client.Administration.CreateAgentAsync(\n    model: modelDeploymentName,\n    name: \"Math Tutor\",\n    instructions: \"You are a personal math tutor. Write and run code to answer math questions.\",\n    tools: [new CodeInterpreterToolDefinition()]\n);\n```\n\n### 2. Create Thread and Message\n\n```csharp\n// Create thread\nPersistentAgentThread thread = await client.Threads.CreateThreadAsync();\n\n// Create message\nawait client.Messages.CreateMessageAsync(\n    thread.Id,\n    MessageRole.User,\n    \"I need to solve the equation `3x + 11 = 14`. Can you help me?\"\n);\n```\n\n### 3. Run Agent (Polling)\n\n```csharp\n// Create run\nThreadRun run = await client.Runs.CreateRunAsync(\n    thread.Id,\n    agent.Id,\n    additionalInstructions: \"Please address the user as Jane Doe.\"\n);\n\n// Poll for completion\ndo\n{\n    await Task.Delay(TimeSpan.FromMilliseconds(500));\n    run = await client.Runs.GetRunAsync(thread.Id, run.Id);\n}\nwhile (run.Status == RunStatus.Queued || run.Status == RunStatus.InProgress);\n\n// Retrieve messages\nawait foreach (PersistentThreadMessage message in client.Messages.GetMessagesAsync(\n    threadId: thread.Id, \n    order: ListSortOrder.Ascending))\n{\n    Console.Write($\"{message.Role}: \");\n    foreach (MessageContent content in message.ContentItems)\n    {\n        if (content is MessageTextContent textContent)\n            Console.WriteLine(textContent.Text);\n    }\n}\n```\n\n### 4. Streaming Response\n\n```csharp\nAsyncCollectionResult<StreamingUpdate> stream = client.Runs.CreateRunStreamingAsync(\n    thread.Id, \n    agent.Id\n);\n\nawait foreach (StreamingUpdate update in stream)\n{\n    if (update.UpdateKind == StreamingUpdateReason.RunCreated)\n    {\n        Console.WriteLine(\"--- Run started! ---\");\n    }\n    else if (update is MessageContentUpdate contentUpdate)\n    {\n        Console.Write(contentUpdate.Text);\n    }\n    else if (update.UpdateKind == StreamingUpdateReason.RunCompleted)\n    {\n        Console.WriteLine(\"\\n--- Run completed! ---\");\n    }\n}\n```\n\n### 5. Function Calling\n\n```csharp\n// Define function tool\nFunctionToolDefinition weatherTool = new(\n    name: \"getCurrentWeather\",\n    description: \"Gets the current weather at a location.\",\n    parameters: BinaryData.FromObjectAsJson(new\n    {\n        Type = \"object\",\n        Properties = new\n        {\n            Location = new { Type = \"string\", Description = \"City and state, e.g. San Francisco, CA\" },\n            Unit = new { Type = \"string\", Enum = new[] { \"c\", \"f\" } }\n        },\n        Required = new[] { \"location\" }\n    }, new JsonSerializerOptions { PropertyNamingPolicy = JsonNamingPolicy.CamelCase })\n);\n\n// Create agent with function\nPersistentAgent agent = await client.Administration.CreateAgentAsync(\n    model: modelDeploymentName,\n    name: \"Weather Bot\",\n    instructions: \"You are a weather bot.\",\n    tools: [weatherTool]\n);\n\n// Handle function calls during polling\ndo\n{\n    await Task.Delay(500);\n    run = await client.Runs.GetRunAsync(thread.Id, run.Id);\n\n    if (run.Status == RunStatus.RequiresAction \n        && run.RequiredAction is SubmitToolOutputsAction submitAction)\n    {\n        List<ToolOutput> outputs = [];\n        foreach (RequiredToolCall toolCall in submitAction.ToolCalls)\n        {\n            if (toolCall is RequiredFunctionToolCall funcCall)\n            {\n                // Execute function and get result\n                string result = ExecuteFunction(funcCall.Name, funcCall.Arguments);\n                outputs.Add(new ToolOutput(toolCall, result));\n            }\n        }\n        run = await client.Runs.SubmitToolOutputsToRunAsync(run, outputs, toolApprovals: null);\n    }\n}\nwhile (run.Status == RunStatus.Queued || run.Status == RunStatus.InP",
  "tags": [
    "python",
    "api",
    "mcp",
    "ai",
    "agent",
    "gpt",
    "workflow",
    "document",
    "azure",
    "cro"
  ],
  "useCases": [],
  "scrapedAt": "2026-02-14T07:02:42.255Z"
}