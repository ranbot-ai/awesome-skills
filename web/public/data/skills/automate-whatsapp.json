{
  "id": "antigravity-automate-whatsapp",
  "name": "automate-whatsapp",
  "slug": "automate-whatsapp",
  "description": "Build WhatsApp automations with Kapso workflows: configure WhatsApp triggers, edit workflow graphs, manage executions, deploy functions, and use databases/integrations for state. Use when automating WhatsApp conversations and event handling.",
  "category": "AI & Agents",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/automate-whatsapp",
  "content": "\n# Automate WhatsApp\n\n## When to use\n\nUse this skill to build and run WhatsApp automations: workflow CRUD, graph edits, triggers, executions, function management, app integrations, and D1 database operations.\n\n## Setup\n\nEnv vars:\n- `KAPSO_API_BASE_URL` (host only, no `/platform/v1`)\n- `KAPSO_API_KEY`\n\n## How to\n\n### Edit a workflow graph\n\n1. Fetch graph: `node scripts/get-graph.js <workflow_id>` (note the `lock_version`)\n2. Edit the JSON (see graph rules below)\n3. Validate: `node scripts/validate-graph.js --definition-file <path>`\n4. Update: `node scripts/update-graph.js <workflow_id> --expected-lock-version <n> --definition-file <path>`\n5. Re-fetch to confirm\n\nFor small edits, use `edit-graph.js` with `--old-file` and `--new-file` instead.\n\nIf you get a lock_version conflict: re-fetch, re-apply changes, retry with new lock_version.\n\n### Manage triggers\n\n1. List: `node scripts/list-triggers.js <workflow_id>`\n2. Create: `node scripts/create-trigger.js <workflow_id> --trigger-type <type> --phone-number-id <id>`\n3. Toggle: `node scripts/update-trigger.js --trigger-id <id> --active true|false`\n4. Delete: `node scripts/delete-trigger.js --trigger-id <id>`\n\nFor inbound_message triggers, first run `node scripts/list-whatsapp-phone-numbers.js` to get `phone_number_id`.\n\n### Debug executions\n\n1. List: `node scripts/list-executions.js <workflow_id>`\n2. Inspect: `node scripts/get-execution.js <execution-id>`\n3. Get value: `node scripts/get-context-value.js <execution-id> --variable-path vars.foo`\n4. Events: `node scripts/list-execution-events.js <execution-id>`\n\n### Create and deploy a function\n\n1. Write code with handler signature (see function rules below)\n2. Create: `node scripts/create-function.js --name <name> --code-file <path>`\n3. Deploy: `node scripts/deploy-function.js --function-id <id>`\n4. Verify: `node scripts/get-function.js --function-id <id>`\n\n### Set up agent node with app integrations\n\n1. Find model: `node scripts/list-provider-models.js`\n2. Find account: `node scripts/list-accounts.js --app-slug <slug>` (use `pipedream_account_id`)\n3. Find action: `node scripts/search-actions.js --query <word> --app-slug <slug>` (action_id = key)\n4. Create integration: `node scripts/create-integration.js --action-id <id> --app-slug <slug> --account-id <id> --configured-props <json>`\n5. Add tools to agent node via `flow_agent_app_integration_tools`\n\n### Database CRUD\n\n1. List tables: `node scripts/list-tables.js`\n2. Query: `node scripts/query-rows.js --table <name> --filters <json>`\n3. Create/update/delete with row scripts\n\n## Graph rules\n\n- Exactly one start node with `id` = `start`\n- Never change existing node IDs\n- Use `{node_type}_{timestamp_ms}` for new node IDs\n- Non-decide nodes have 0 or 1 outgoing `next` edge\n- Decide edge labels must match `conditions[].label`\n- Edge keys are `source`/`target`/`label` (not `from`/`to`)\n\nFor full schema details, see `references/graph-contract.md`.\n\n## Function rules\n\n```js\nasync function handler(request, env) {\n  // Parse input\n  const body = await request.json();\n  // Use env.KV and env.DB as needed\n  return new Response(JSON.stringify({ result: \"ok\" }));\n}\n```\n\n- Do NOT use `export`, `export default`, or arrow functions\n- Return a `Response` object\n\n## Execution context\n\nAlways use this structure:\n- `vars` - user-defined variables\n- `system` - system variables\n- `context` - channel data\n- `metadata` - request metadata\n\n## Scripts\n\n### Workflows\n\n| Script | Purpose |\n|--------|---------|\n| `list-workflows.js` | List workflows (metadata only) |\n| `get-workflow.js` | Get workflow metadata |\n| `create-workflow.js` | Create a workflow |\n| `update-workflow-settings.js` | Update workflow settings |\n\n### Graph\n\n| Script | Purpose |\n|--------|---------|\n| `get-graph.js` | Get workflow graph + lock_version |\n| `edit-graph.js` | Patch graph via string replacement |\n| `update-graph.js` | Replace entire graph |\n| `validate-graph.js` | Validate graph structure locally |\n\n### Triggers\n\n| Script | Purpose |\n|--------|---------|\n| `list-triggers.js` | List triggers for a workflow |\n| `create-trigger.js` | Create a trigger |\n| `update-trigger.js` | Enable/disable a trigger |\n| `delete-trigger.js` | Delete a trigger |\n| `list-whatsapp-phone-numbers.js` | List phone numbers for trigger setup |\n\n### Executions\n\n| Script | Purpose |\n|--------|---------|\n| `list-executions.js` | List executions |\n| `get-execution.js` | Get execution details |\n| `get-context-value.js` | Read value from execution context |\n| `update-execution-status.js` | Force execution state |\n| `resume-execution.js` | Resume waiting execution |\n| `list-execution-events.js` | List execution events |\n\n### Functions\n\n| Script | Purpose |\n|--------|---------|\n| `list-functions.js` | List project functions |\n| `get-function.js` | Get function details + code |\n| `create-function.js` | Create a function |\n| `update-function.js` | Update function code |\n| `deploy-function.js` | Deploy function to runtime |\n| `invoke-function.js` | Invok",
  "tags": [
    "node",
    "api",
    "ai",
    "agent",
    "automation",
    "workflow",
    "template"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-31T06:50:43.555Z"
}