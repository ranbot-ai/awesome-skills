{
  "id": "antigravity-idor-testing",
  "name": "IDOR Vulnerability Testing",
  "slug": "idor-testing",
  "description": "This skill should be used when the user asks to \"test for insecure direct object references,\" \"find IDOR vulnerabilities,\" \"exploit broken access control,\" \"enumerate user IDs or object references,\" or \"bypass authorization to access other users' data.\" It provides comprehensive guidance for detecti",
  "category": "Security & Systems",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/idor-testing",
  "content": "\n# IDOR Vulnerability Testing\n\n## Purpose\n\nProvide systematic methodologies for identifying and exploiting Insecure Direct Object Reference (IDOR) vulnerabilities in web applications. This skill covers both database object references and static file references, detection techniques using parameter manipulation and enumeration, exploitation via Burp Suite, and remediation strategies for securing applications against unauthorized access.\n\n## Inputs / Prerequisites\n\n- **Target Web Application**: URL of application with user-specific resources\n- **Multiple User Accounts**: At least two test accounts to verify cross-user access\n- **Burp Suite or Proxy Tool**: Intercepting proxy for request manipulation\n- **Authorization**: Written permission for security testing\n- **Understanding of Application Flow**: Knowledge of how objects are referenced (IDs, filenames)\n\n## Outputs / Deliverables\n\n- **IDOR Vulnerability Report**: Documentation of discovered access control bypasses\n- **Proof of Concept**: Evidence of unauthorized data access across user contexts\n- **Affected Endpoints**: List of vulnerable API endpoints and parameters\n- **Impact Assessment**: Classification of data exposure severity\n- **Remediation Recommendations**: Specific fixes for identified vulnerabilities\n\n## Core Workflow\n\n### 1. Understand IDOR Vulnerability Types\n\n#### Direct Reference to Database Objects\nOccurs when applications reference database records via user-controllable parameters:\n```\n# Original URL (authenticated as User A)\nexample.com/user/profile?id=2023\n\n# Manipulation attempt (accessing User B's data)\nexample.com/user/profile?id=2022\n```\n\n#### Direct Reference to Static Files\nOccurs when applications expose file paths or names that can be enumerated:\n```\n# Original URL (User A's receipt)\nexample.com/static/receipt/205.pdf\n\n# Manipulation attempt (User B's receipt)\nexample.com/static/receipt/200.pdf\n```\n\n### 2. Reconnaissance and Setup\n\n#### Create Multiple Test Accounts\n```\nAccount 1: \"attacker\" - Primary testing account\nAccount 2: \"victim\" - Account whose data we attempt to access\n```\n\n#### Identify Object References\nCapture and analyze requests containing:\n- Numeric IDs in URLs: `/api/user/123`\n- Numeric IDs in parameters: `?id=123&action=view`\n- Numeric IDs in request body: `{\"userId\": 123}`\n- File paths: `/download/receipt_123.pdf`\n- GUIDs/UUIDs: `/profile/a1b2c3d4-e5f6-...`\n\n#### Map User IDs\n```\n# Access user ID endpoint (if available)\nGET /api/user-id/\n\n# Note ID patterns:\n# - Sequential integers (1, 2, 3...)\n# - Auto-incremented values\n# - Predictable patterns\n```\n\n### 3. Detection Techniques\n\n#### URL Parameter Manipulation\n```\n# Step 1: Capture original authenticated request\nGET /api/user/profile?id=1001 HTTP/1.1\nCookie: session=attacker_session\n\n# Step 2: Modify ID to target another user\nGET /api/user/profile?id=1000 HTTP/1.1\nCookie: session=attacker_session\n\n# Vulnerable if: Returns victim's data with attacker's session\n```\n\n#### Request Body Manipulation\n```\n# Original POST request\nPOST /api/address/update HTTP/1.1\nContent-Type: application/json\nCookie: session=attacker_session\n\n{\"id\": 5, \"userId\": 1001, \"address\": \"123 Attacker St\"}\n\n# Modified request targeting victim\n{\"id\": 5, \"userId\": 1000, \"address\": \"123 Attacker St\"}\n```\n\n#### HTTP Method Switching\n```\n# Original GET request may be protected\nGET /api/admin/users/1000 → 403 Forbidden\n\n# Try alternative methods\nPOST /api/admin/users/1000 → 200 OK (Vulnerable!)\nPUT /api/admin/users/1000 → 200 OK (Vulnerable!)\n```\n\n### 4. Exploitation with Burp Suite\n\n#### Manual Exploitation\n```\n1. Configure browser proxy through Burp Suite\n2. Login as \"attacker\" user\n3. Navigate to profile/data page\n4. Enable Intercept in Proxy tab\n5. Capture request with user ID\n6. Modify ID to victim's ID\n7. Forward request\n8. Observe response for victim's data\n```\n\n#### Automated Enumeration with Intruder\n```\n1. Send request to Intruder (Ctrl+I)\n2. Clear all payload positions\n3. Select ID parameter as payload position\n4. Configure attack type: Sniper\n5. Payload settings:\n   - Type: Numbers\n   - Range: 1 to 10000\n   - Step: 1\n6. Start attack\n7. Analyze responses for 200 status codes\n```\n\n#### Battering Ram Attack for Multiple Positions\n```\n# When same ID appears in multiple locations\nPUT /api/addresses/§5§/update HTTP/1.1\n\n{\"id\": §5§, \"userId\": 3}\n\nAttack Type: Battering Ram\nPayload: Numbers 1-1000\n```\n\n### 5. Common IDOR Locations\n\n#### API Endpoints\n```\n/api/user/{id}\n/api/profile/{id}\n/api/order/{id}\n/api/invoice/{id}\n/api/document/{id}\n/api/message/{id}\n/api/address/{id}/update\n/api/address/{id}/delete\n```\n\n#### File Downloads\n```\n/download/invoice_{id}.pdf\n/static/receipts/{id}.pdf\n/uploads/documents/{filename}\n/files/reports/report_{date}_{id}.xlsx\n```\n\n#### Query Parameters\n```\n?userId=123\n?orderId=456\n?documentId=789\n?file=report_123.pdf\n?account=user@email.com\n```\n\n## Quick Reference\n\n### IDOR Testing Checklist\n\n| Test | Method | Indicator of Vulnerability |\n|------|--------|-------------",
  "tags": [
    "python",
    "javascript",
    "pdf",
    "xlsx",
    "api",
    "ai",
    "workflow",
    "template",
    "document",
    "security"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-26T13:19:01.550Z"
}