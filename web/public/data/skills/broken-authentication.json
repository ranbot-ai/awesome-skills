{
  "id": "antigravity-broken-authentication",
  "name": "Broken Authentication Testing",
  "slug": "broken-authentication",
  "description": "This skill should be used when the user asks to \"test for broken authentication vulnerabilities\", \"assess session management security\", \"perform credential stuffing tests\", \"evaluate password policies\", \"test for session fixation\", or \"identify authentication bypass flaws\". It provides comprehensive",
  "category": "Security & Systems",
  "source": "antigravity",
  "repoUrl": "https://github.com/sickn33/antigravity-awesome-skills",
  "skillUrl": "https://github.com/sickn33/antigravity-awesome-skills/tree/main/skills/broken-authentication",
  "content": "\n# Broken Authentication Testing\n\n## Purpose\n\nIdentify and exploit authentication and session management vulnerabilities in web applications. Broken authentication consistently ranks in the OWASP Top 10 and can lead to account takeover, identity theft, and unauthorized access to sensitive systems. This skill covers testing methodologies for password policies, session handling, multi-factor authentication, and credential management.\n\n## Prerequisites\n\n### Required Knowledge\n- HTTP protocol and session mechanisms\n- Authentication types (SFA, 2FA, MFA)\n- Cookie and token handling\n- Common authentication frameworks\n\n### Required Tools\n- Burp Suite Professional or Community\n- Hydra or similar brute-force tools\n- Custom wordlists for credential testing\n- Browser developer tools\n\n### Required Access\n- Target application URL\n- Test account credentials\n- Written authorization for testing\n\n## Outputs and Deliverables\n\n1. **Authentication Assessment Report** - Document all identified vulnerabilities\n2. **Credential Testing Results** - Brute-force and dictionary attack outcomes\n3. **Session Security Analysis** - Token randomness and timeout evaluation\n4. **Remediation Recommendations** - Security hardening guidance\n\n## Core Workflow\n\n### Phase 1: Authentication Mechanism Analysis\n\nUnderstand the application's authentication architecture:\n\n```\n# Identify authentication type\n- Password-based (forms, basic auth, digest)\n- Token-based (JWT, OAuth, API keys)\n- Certificate-based (mutual TLS)\n- Multi-factor (SMS, TOTP, hardware tokens)\n\n# Map authentication endpoints\n/login, /signin, /authenticate\n/register, /signup\n/forgot-password, /reset-password\n/logout, /signout\n/api/auth/*, /oauth/*\n```\n\nCapture and analyze authentication requests:\n\n```http\nPOST /login HTTP/1.1\nHost: target.com\nContent-Type: application/x-www-form-urlencoded\n\nusername=test&password=test123\n```\n\n### Phase 2: Password Policy Testing\n\nEvaluate password requirements and enforcement:\n\n```bash\n# Test minimum length (a, ab, abcdefgh)\n# Test complexity (password, password1, Password1!)\n# Test common weak passwords (123456, password, qwerty, admin)\n# Test username as password (admin/admin, test/test)\n```\n\nDocument policy gaps: Minimum length <8, no complexity, common passwords allowed, username as password.\n\n### Phase 3: Credential Enumeration\n\nTest for username enumeration vulnerabilities:\n\n```bash\n# Compare responses for valid vs invalid usernames\n# Invalid: \"Invalid username\" vs Valid: \"Invalid password\"\n# Check timing differences, response codes, registration messages\n```\n\n# Password reset\n\"Email sent if account exists\" (secure)\n\"No account with that email\" (leaks info)\n\n# API responses\n{\"error\": \"user_not_found\"}\n{\"error\": \"invalid_password\"}\n```\n\n### Phase 4: Brute Force Testing\n\nTest account lockout and rate limiting:\n\n```bash\n# Using Hydra for form-based auth\nhydra -l admin -P /usr/share/wordlists/rockyou.txt \\\n  target.com http-post-form \\\n  \"/login:username=^USER^&password=^PASS^:Invalid credentials\"\n\n# Using Burp Intruder\n1. Capture login request\n2. Send to Intruder\n3. Set payload positions on password field\n4. Load wordlist\n5. Start attack\n6. Analyze response lengths/codes\n```\n\nCheck for protections:\n\n```bash\n# Account lockout\n- After how many attempts?\n- Duration of lockout?\n- Lockout notification?\n\n# Rate limiting\n- Requests per minute limit?\n- IP-based or account-based?\n- Bypass via headers (X-Forwarded-For)?\n\n# CAPTCHA\n- After failed attempts?\n- Easily bypassable?\n```\n\n### Phase 5: Credential Stuffing\n\nTest with known breached credentials:\n\n```bash\n# Credential stuffing differs from brute force\n# Uses known email:password pairs from breaches\n\n# Using Burp Intruder with Pitchfork attack\n1. Set username and password as positions\n2. Load email list as payload 1\n3. Load password list as payload 2 (matched pairs)\n4. Analyze for successful logins\n\n# Detection evasion\n- Slow request rate\n- Rotate source IPs\n- Randomize user agents\n- Add delays between attempts\n```\n\n### Phase 6: Session Management Testing\n\nAnalyze session token security:\n\n```bash\n# Capture session cookie\nCookie: SESSIONID=abc123def456\n\n# Test token characteristics\n1. Entropy - Is it random enough?\n2. Length - Sufficient length (128+ bits)?\n3. Predictability - Sequential patterns?\n4. Secure flags - HttpOnly, Secure, SameSite?\n```\n\nSession token analysis:\n\n```python\n#!/usr/bin/env python3\nimport requests\nimport hashlib\n\n# Collect multiple session tokens\ntokens = []\nfor i in range(100):\n    response = requests.get(\"https://target.com/login\")\n    token = response.cookies.get(\"SESSIONID\")\n    tokens.append(token)\n\n# Analyze for patterns\n# Check for sequential increments\n# Calculate entropy\n# Look for timestamp components\n```\n\n### Phase 7: Session Fixation Testing\n\nTest if session is regenerated after authentication:\n\n```bash\n# Step 1: Get session before login\nGET /login HTTP/1.1\nResponse: Set-Cookie: SESSIONID=abc123\n\n# Step 2: Login with same session\nPOST /login HTTP/1.1\nCookie: SESSIONID=ab",
  "tags": [
    "python",
    "api",
    "ai",
    "agent",
    "llm",
    "workflow",
    "document",
    "security",
    "vulnerability",
    "aws"
  ],
  "useCases": [],
  "scrapedAt": "2026-01-26T13:17:06.932Z"
}